<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarefa 9: Regi√µes cr√≠ticas nomeadas e Locks expl√≠citos</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
        }
        h3 {
            color: #2980b9;
            margin-top: 25px;
        }
        h4 {
            color: #8e44ad;
            margin-top: 20px;
        }
        code {
            background-color: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #e74c3c;
        }
        pre {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
        }
        pre code {
            background-color: transparent;
            color: #ecf0f1;
            padding: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .highlight {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .success {
            color: #27ae60;
            font-weight: bold;
        }
        .warning {
            color: #f39c12;
            font-weight: bold;
        }
        .error {
            color: #e74c3c;
            font-weight: bold;
        }
        ul {
            padding-left: 25px;
        }
        li {
            margin: 8px 0;
        }
        .image-container {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 10px;
            border: 2px dashed #3498db;
        }
        .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .image-caption {
            margin-top: 15px;
            font-style: italic;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Tarefa 9: Regi√µes cr√≠ticas nomeadas e Locks expl√≠citos</h1>

        <h2>Descri√ß√£o</h2>
        <p>Este programa demonstra o uso de regi√µes cr√≠ticas nomeadas e locks expl√≠citos em OpenMP para realizar inser√ß√µes concorrentes em m√∫ltiplas listas encadeadas, garantindo a integridade dos dados e evitando condi√ß√µes de corrida.</p>

        <h2>Locks Expl√≠citos (Regi√µes Cr√≠ticas Nomeadas)</h2>
        
        <h4>O que s√£o Locks?</h4>
        <div class="highlight">
            <p><strong>Lock</strong> (ou mutex - mutual exclusion) √© um mecanismo de sincroniza√ß√£o que garante acesso <strong>mutuamente exclusivo</strong> a um recurso compartilhado. Funciona como uma "chave digital" que apenas uma thread pode possuir por vez.</p>
        </div>

        <h4>Conceito Fundamental</h4>
        <p>Um lock possui dois estados:</p>
        <ul>
            <li><strong>üîì Desbloqueado (unlocked)</strong>: Recurso dispon√≠vel, qualquer thread pode adquirir</li>
            <li><strong>üîí Bloqueado (locked)</strong>: Recurso ocupado, outras threads ficam em espera</li>
        </ul>

        <h4>Opera√ß√µes B√°sicas de Lock</h4>
        <pre><code>// 1. Declara√ß√£o do lock
omp_lock_t meu_lock;

// 2. Inicializa√ß√£o
omp_init_lock(&amp;meu_lock);

// 3. Adquirir o lock (bloqueia se necess√°rio)
omp_set_lock(&amp;meu_lock);
// SE√á√ÉO CR√çTICA - apenas uma thread executa
omp_unset_lock(&amp;meu_lock);

// 4. Destrui√ß√£o (limpeza)
omp_destroy_lock(&amp;meu_lock);</code></pre>

        <h4>Exemplo Simples de Uso: Contador Compartilhado</h4>
        <pre><code>int contador = 0;
omp_lock_t lock_contador;

// Thread segura incrementando contador
omp_set_lock(&amp;lock_contador);
contador++;  // Se√ß√£o cr√≠tica protegida
printf("Contador: %d\n", contador);
omp_unset_lock(&amp;lock_contador);</code></pre>

        <h4>Implementa√ß√£o no Nosso Projeto</h4>
        <ul>
            <li>Cada lista possui seu pr√≥prio lock (<code>omp_lock_t</code>)</li>
            <li>Inser√ß√µes em listas diferentes podem ocorrer simultaneamente</li>
            <li>Inser√ß√µes na mesma lista s√£o serializadas automaticamente</li>
            <li>Uso de <code>omp_set_lock()</code> e <code>omp_unset_lock()</code> para controle expl√≠cito</li>
        </ul>

        <h4>Vantagem dos Locks vs Regi√µes Cr√≠ticas</h4>
        <div class="highlight">
            <p><strong>Flexibilidade:</strong> Locks podem ser criados dinamicamente em runtime, enquanto regi√µes cr√≠ticas nomeadas devem ser definidas estaticamente no c√≥digo.</p>
        </div>

        <h3>Por que Locks Expl√≠citos s√£o Necess√°rios?</h3>

        <h4>Limita√ß√µes das Regi√µes Cr√≠ticas Tradicionais</h4>

        <h5>1. <strong>Problema da Serializa√ß√£o Global</strong></h5>
        <pre><code>// Abordagem INADEQUADA com regi√£o cr√≠tica global
#pragma omp critical
{
    insert_element(random_list, value);  // TODAS as inser√ß√µes serializadas!
}</code></pre>
        <p><strong>Problema</strong>: Mesmo inserindo em listas diferentes, threads ficam bloqueadas.</p>

        <h5>2. <strong>Regi√µes Cr√≠ticas Nomeadas - Limita√ß√£o Est√°tica</strong></h5>
        <pre><code>// Abordagem LIMITADA com nomes fixos
#pragma omp critical(list1)
{
    insert_element(&amp;list1, value);
}

#pragma omp critical(list2)
{
    insert_element(&amp;list2, value);
}</code></pre>
        <p><strong>Problema</strong>: Funciona apenas para n√∫mero fixo e predefinido de listas.</p>

        <h4>Solu√ß√£o com Locks Expl√≠citos</h4>

        <h5>3. <strong>Locks Din√¢micos - Solu√ß√£o Escal√°vel</strong></h5>
        <pre><code>//SOLU√á√ÉO: lock por lista, dinamicamente alocado
omp_set_lock(&amp;lists[chosen_list].lock);
insert_element(&amp;lists[chosen_list], value);
omp_unset_lock(&amp;lists[chosen_list].lock);</code></pre>

        <h4>Vantagens dos Locks Expl√≠citos</h4>
        <ol>
            <li><strong>Granularidade Din√¢mica</strong>: Cada lista tem seu lock individual</li>
            <li><strong>Escalabilidade</strong>: Funciona com qualquer n√∫mero N de listas</li>
            <li><strong>Paralelismo M√°ximo</strong>: Threads em listas diferentes n√£o se bloqueiam</li>
            <li><strong>Flexibilidade</strong>: N√∫mero de recursos protegidos determinado em runtime</li>
            <li><strong>Performance</strong>: Conten√ß√£o m√≠nima entre threads</li>
        </ol>

        <h4>An√°lise Comparativa</h4>
        <table>
            <thead>
                <tr>
                    <th>Abordagem</th>
                    <th>Paralelismo</th>
                    <th>Escalabilidade</th>
                    <th>Flexibilidade</th>
                    <th>Performance</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>#pragma omp critical</code></td>
                    <td class="error">‚ùå Serializa√ß√£o total</td>
                    <td class="error">‚ùå N√£o escala</td>
                    <td class="error">‚ùå Inflex√≠vel</td>
                    <td class="error">‚ùå Baixa</td>
                </tr>
                <tr>
                    <td><code>#pragma omp critical(nome)</code></td>
                    <td class="success">‚úÖ Parcial</td>
                    <td class="error">‚ùå Limitado</td>
                    <td class="error">‚ùå Est√°tico</td>
                    <td class="warning">üü° M√©dia</td>
                </tr>
                <tr>
                    <td><strong>Locks Expl√≠citos</strong></td>
                    <td class="success">‚úÖ <strong>M√°ximo</strong></td>
                    <td class="success">‚úÖ <strong>Ilimitado</strong></td>
                    <td class="success">‚úÖ <strong>Din√¢mico</strong></td>
                    <td class="success">‚úÖ <strong>Alta</strong></td>
                </tr>
            </tbody>
        </table>

        <div class="highlight">
            <h4>Cen√°rio Pr√°tico</h4>
            <p>Com <strong>4 threads</strong> e <strong>3 listas</strong>:</p>
            <ul>
                <li><strong>Regi√£o cr√≠tica global</strong>: M√°ximo 1 thread ativa (25% uso)</li>
                <li><strong>Locks expl√≠citos</strong>: At√© 3 threads ativas simultaneamente (75% uso)</li>
            </ul>
        </div>

        <h2>Caracter√≠sticas do Programa</h2>

        <h3>1. Estrutura de Dados</h3>
        <ul>
            <li><strong>Lista Encadeada</strong>: Cada lista possui sua pr√≥pria estrutura com:
                <ul>
                    <li>Ponteiro para o primeiro n√≥ (<code>head</code>)</li>
                    <li>Lock exclusivo (<code>omp_lock_t</code>)</li>
                    <li>Contador de elementos (<code>count</code>)</li>
                    <li>Identificador √∫nico (<code>id</code>)</li>
                </ul>
            </li>
        </ul>

        <h3>2. Funcionalidades</h3>

        <h4>Programa Interativo Principal</h4>
        <ul>
            <li>Aceita n√∫mero de listas definido pelo usu√°rio</li>
            <li>Distribui inser√ß√µes aleatoriamente entre todas as listas</li>
            <li>Escal√°vel para qualquer n√∫mero de listas</li>
            <li>Interface interativa para configura√ß√£o personalizada</li>
            <li>Execu√ß√£o direta sem demonstra√ß√µes preliminares</li>
        </ul>

        <h2>Exemplo de Sa√≠da</h2>
        <pre><code>TAREFA 9: Regi√µes cr√≠ticas nomeadas e Locks expl√≠citos
======================================================

=== TESTE INTERATIVO ===
Digite o n√∫mero de listas: 2
Digite o n√∫mero de inser√ß√µes: 20
Digite o n√∫mero de threads: 3

=== PROGRAMA COM 2 LISTAS ===
N√∫mero de inser√ß√µes: 20
N√∫mero de threads: 3

Thread 0 inserindo 968 na Lista 2
Thread 1 inserindo 421 na Lista 2    ‚Üê Simult√¢neo!
Thread 0 inserindo 727 na Lista 2
Thread 2 inserindo 649 na Lista 2
Thread 0 inserindo 717 na Lista 1    ‚Üê Mudan√ßa de lista!
...

Resultados ap√≥s 20 inser√ß√µes em 2 listas:
Lista 1 (11 elementos): 432 471 349 384 ...
Lista 2 (9 elementos): 283 102 819 541 ...
Tempo total: 0.0152 segundos
Total de elementos: 20

Programa conclu√≠do com sucesso!</code></pre>

        <h2>Conceitos Demonstrados</h2>

        <h3>1. Locks Expl√≠citos vs Regi√µes Cr√≠ticas</h3>
        <ul>
            <li><strong>Diferen√ßa fundamental</strong>: Locks permitem granularidade din√¢mica</li>
            <li><strong>Escalabilidade</strong>: Funciona com N listas determinado em runtime</li>
            <li><strong>Performance</strong>: Paralelismo real entre recursos diferentes</li>
        </ul>

        <h3>2. Thread Safety Din√¢mica</h3>
        <ul>
            <li><strong>Prote√ß√£o espec√≠fica</strong>: Cada lista protegida individualmente</li>
            <li><strong>Conten√ß√£o m√≠nima</strong>: Threads s√≥ competem pela mesma lista</li>
            <li><strong>Sincroniza√ß√£o eficiente</strong>: Locks apenas quando necess√°rio</li>
        </ul>

        <h3>3. Paralelismo de Granularidade Fina</h3>
        <ul>
            <li><strong>M√∫ltiplos recursos</strong>: V√°rias listas acessadas simultaneamente</li>
            <li><strong>Balanceamento</strong>: Distribui√ß√£o aleat√≥ria equilibra carga</li>
            <li><strong>Escalabilidade</strong>: Performance melhora com mais listas</li>
        </ul>

        <h2>Vantagens da Abordagem</h2>
        <ol>
            <li><strong>Granularidade Din√¢mica</strong>: Locks espec√≠ficos por lista, n√∫mero vari√°vel</li>
            <li><strong>Paralelismo M√°ximo</strong>: Inser√ß√µes simult√¢neas em listas diferentes</li>
            <li><strong>Flexibilidade Total</strong>: Funciona com qualquer configura√ß√£o N listas</li>
            <li><strong>Seguran√ßa Garantida</strong>: Integridade dos dados sem race conditions</li>
            <li><strong>Performance √ìtima</strong>: Throughput superior a alternativas est√°ticas</li>
            <li><strong>Demonstra√ß√£o Clara</strong>: Visualiza√ß√£o do comportamento paralelo</li>
        </ol>

        <h2>C√≥digo Fonte</h2>
        <div class="image-container">
            <img src="tarefa9.png" alt="C√≥digo fonte da Tarefa 9" />
            <div class="image-caption">
                <strong>Figura 1:</strong> C√≥digo fonte completo da Tarefa 9 - Demonstra√ß√£o de regi√µes cr√≠ticas nomeadas e locks expl√≠citos em OpenMP
            </div>
        </div>
    </div>
</body>
</html>
